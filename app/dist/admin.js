!function(){"use strict";angular.module("question",["ui.router","toaster","ngAnimate"]).config(["$stateProvider","$urlRouterProvider",function(e,t){t.otherwise("/main"),e.state("home",{url:"/main",templateUrl:"/public/src/admin/home/home.tpl"}).state("main",{url:"/login",templateUrl:"/public/src/admin/login/login.tpl",controller:"LoginController as login"}).state("dash",{url:"/dash",templateUrl:"/public/src/admin/dash/dash.tpl",controller:"DashController as dash"}).state("dash.welcome",{url:"/welcome",templateUrl:"/public/src/admin/dash/welcome/welcome.tpl",controller:"WelcomeController as welcome"}).state("dash.add",{url:"/add",templateUrl:"/public/src/admin/dash/addQuestion/add.tpl",controller:"AddController as add"}).state("dash.createTest",{url:"/test",templateUrl:"/public/src/admin/dash/createTest/createTest.tpl",controller:"CreateTestController as test"}).state("dash.preview",{url:"/preview/:testId",templateUrl:"/public/src/admin/dash/previewTest/preview.tpl",controller:"PreviewController as preview"}).state("dash.view",{url:"/view",templateUrl:"/public/src/admin/dash/viewTests/view.tpl",controller:"ViewController as view"})}])}(),angular.module("question").directive("mathjaxBind",function(){return{restrict:"A",controller:["$scope","$element","$attrs",function(e,t,o){e.$watch(o.mathjaxBind,function(e){t.html(e),MathJax.Hub.Queue(["Typeset",MathJax.Hub,t[0]]),e||t.html("")})}]}}),angular.module("question").factory("Test",["$http","User","Host",function(e,t,o){var r=[];return{getTest:function(){return e({method:"GET",url:o.add+"/secure/test",params:{token:t.getToken()}}).then(function(e){return e.data.err?void 0:(r=e.data.tests,e)})["catch"](function(e){return console.log(e),e})},getTestById:function(r){return e({method:"GET",url:o.add+"/secure/test/"+r,params:{token:t.getToken()}}).then(function(e){return console.log(e),e})["catch"](function(e){return console.log(e),e})},enableTest:function(r,n){return e({method:"GET",url:o.add+"/secure/enable/"+r,params:{token:t.getToken(),enable:n}})}}}]),angular.module("question").constant("Host",{add:""}).factory("User",["$http","Host",function(e,t){function o(){return i?i:e({method:"GET",url:t.add+"/secure/question",params:{token:l}}).then(function(e){return i=e.data.questions,e})}function r(){return l}function n(e,t,o){d.name=e,d.ids=o,d.group=t}function s(){return d}function a(){var o=[];return d.ids.forEach(function(e){o.push(i[e].Id)}),e.post(t.add+"/secure/test",{token:l,ids:o,name:d.name,group:d.group})}var l=null,c=null,u=null,i=null,d={ids:[],name:null,group:null},g=function(o){return console.log(o),e.post(t.add+"/login",o).then(function(e){return console.log(e),l=e.data.token,c=e.data.teacher.Subject,u=e.data.teacher.Username,e})["catch"](function(e){return console.log(e),e})},p=function(o,r,n){if(console.log("Q in addQues factory",o),l&&n&&u){var s={questionText:o.questionText,option1:o.option1,option2:o.option2,option3:o.option3,option4:o.option4,token:l,subject:n,correct:o.correct,tags:r};return console.log(s),e.post(t.add+"/secure/question",s)}return console.log("This hould not be happening"),new Error("Go to hell")},h=function(o){return l&&o.name?e.post(t.add+"/secure/tags",{name:o.name,token:l}):new Error("Not signed in or no tag")},m=function(){return e.get(t.add+"/tags")},f=function(o){return l&&o.name?e.post(t.add+"/subject",{name:o.name,token:l}):(console.log("Throw"),new Error("Not signed in or no tag"))},T=function(){return e.get(t.add+"/subject")},b=function(){return!!l};return{login:g,add:p,newTag:h,getTags:m,newSubject:f,getSubject:T,isLoggedIn:b,getQuestions:o,setTest:n,getTest:s,createTest:a,getToken:r}}]),angular.module("question").controller("DashController",["$state","User",function(e,t){if(console.log("dash Controller"),!t.isLoggedIn())return void e.go("main");e.go("dash.welcome");var o=this;o.add=function(){console.log("Trying to go"),e.go("dash.add")},o.questionTemp=!1,o.testTemp=!1}]),angular.module("question").controller("LoginController",["User","$state","toaster",function(e,t,o){console.log("main Controller");var r=this;r.loginText="Submit",r.doLogin=function(){r.loginText="Please Wait.......",console.log("Username & Password",r.user),e.login(r.user).then(function(e){console.log(e.data.msg),0==e.data.err?(console.log("Toast"),o.pop("success","Success","Verified"),t.go("dash")):(console.log("Nope",e),o.pop("error","Error ocurred","OOps Try Again"),r.loginText="Submit")})["catch"](function(e){console.log(e.data.msg),o.pop("error","Error","Damn Boy Damn!!"),r.loginText="Submit"})}}]),angular.module("question").controller("AddController",["User","toaster",function(e,t){function o(){e.getTags().then(function(e){if(e.data.err===!1){n.tags=e.data.tags;var o=n.tags.length/2;n.tags1=n.tags.slice(0,o),n.tags2=n.tags.slice(o,2*o),console.log(e.data.tags)}else t.pop("error","Colud not get Tags",e.data.msg)})["catch"](function(e){t.pop("error","Server No gud ","Ouuta here")})}function r(){e.getSubject().then(function(e){e.data.err===!1?(n.subjects=e.data.subjects,console.log(e.data.subjects)):t.pop("error","Colud not get Tags",e.data.msg)})["catch"](function(e){t.pop("error","Server No gud ","Ouuta here")})}console.log("add Controller");var n=this;n.question={},n.addText="Add",n.submit=function(){if(console.log(n.question),!(n.question.questionText&&n.question.option1&&n.question.option2&&n.question.option3&&n.question.option4&&n.question.correct))return void t.pop("error","Error ocurred","Missing Values");if(!n.subjectSelect)return void t.pop("error","Error ocurred","No Subjects");n.addText="Adding.............";var o=e.add(n.question,n.selectedTags,n.subjectSelect);console.log(o instanceof Error),o instanceof Error?(n.addText="Add",t.pop("error","Error ocurred","Type the question")):o.then(function(e){console.log(e),0==e.data.err?(console.log("Successfully added"),n.question.questionText="",n.question={},t.pop("success","Success","Question Added")):(console.log("error"),t.pop("error","Error ocurred","Missing Values")),n.addText="Add"})["catch"](function(e){n.question.questionText="",n.question={},console.log("Errror",e),t.pop("error","Error ocurred","OOps Try Again"),n.addText="Add"})},n.addTag=function(r){if(13===r.keyCode){var s=e.newTag({name:n.newTagText});s instanceof Error?t.pop("error","Error","Could not add Tags"):s.then(function(e){o(),e.data.err===!1?(n.newTagText="",t.pop("success","Success","New tag added")):t.pop("error","Error",e.data.msg)})["catch"](function(e){console.log(e),t.pop("error","Error",response.data.msg)})}},o(),n.Select=function(){console.log(n.tagSelect);var e=[];for(var t in n.tagSelect)n.tagSelect[t]===!0&&e.push(t);n.selectedTags=e},n.addSubject=function(o){if(13===o.keyCode){var s=e.newSubject({name:n.newSubjectText});s instanceof Error?t.pop("error","Error","Could not add Tags"):s.then(function(e){r(),e.data.err===!1?(n.newTagText="",t.pop("success","Success","New tag added")):t.pop("error","Error",e.data.msg)})["catch"](function(e){console.log(e),t.pop("error","Error",response.data.msg)})}},r(),n.SelectSubject=function(){console.log(n.subjectSelect)}}]),angular.module("question").controller("CreateTestController",["$state","User","toaster",function(e,t,o){console.log("Create Test Controller");var r=this,n=t.getQuestions();"function"==typeof n.then?n.then(function(e){console.log("hi",e),r.questions=e.data.questions})["catch"](function(e){o.pop("error","Error ocurred","Oh boy!! "+e.data.err),console.log("HOHO",e)}):r.questions=n,r.preview=function(){var n=[];if(!r.name||0===r.checked.length)return void o.pop("error","No name","Specify a name for the test");console.log("U should not be here"),console.log(r.checked);for(var s in r.checked)r.checked.hasOwnProperty(s)&&(console.log(s),r.checked[s]&&n.push(s));t.setTest(r.name,r.group,n),e.go("dash.preview")}}]),angular.module("question").controller("PreviewController",["User","toaster","$state","$stateParams","Test",function(e,t,o,r,n){console.log("Preview Controller");var s,a,l,c=this;if(c.questions=[],r.testId){console.log(r.testId);var u=r.testId;n.getTestById(u).then(function(e){c.name=e.data.test.Name,c.submitButtonText="Edit test",c.questions=e.data.questions})["catch"](function(e){console.log("Why not here",e),t.pop("error","OOPS sorry","not there exactly")})}else s=e.getTest(),a=e.getQuestions(),l=s.ids,c.name=s.name,c.questions=[],c.submitButtonText="Create Test",Array.isArray(a)&&l.forEach(function(e){c.questions.push(a[e]),console.log("Q Q")});c.createTest=function(){c.submitButtonText="Creating.........";var r=e.createTest();"function"==typeof r.then&&r.then(function(e){console.log(e),e.data.err?t.pop("error","Error","Sth happened"):(c.submitButtonText="Done",t.pop("success","Success","Test created")),o.go("dash.view")})["catch"](function(e){console.log("Error hogaya",e),c.submitButtonText="Create test",e.data.err?t.pop("error","Error",e.data.err):t.pop("error","Error",e.statusText)})}}]),angular.module("question").controller("ViewController",["Test","toaster",function(e,t){var o=this;e.getTest().then(function(e){console.log(e),o.tests=e.data.tests})["catch"](function(e){console.log(e);var o=e.data.err||e.statusText;t.pop("error","Not happening",o)}),o.EnableTest=function(r,n,s){console.log(n,s),e.enableTest(n,s).then(function(e){console.log(e);var n=1==s?"disabled":"enabled";t.pop("success","Test "+n),o.tests[r].Enable=!s})["catch"](function(e){console.log(e),t.pop("error","Error",e.statusText)})}}]),angular.module("question").controller("WelcomeController",["$state","User",function(e,t){console.log("welcome Controller")}]);